<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Meditation Timer</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    
    body {
      background: #0d1117;
      color: #c9d1d9;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 20px;
    }
    
    .container { text-align: center; max-width: 400px; }
    
    .title { font-size: 28px; margin-bottom: 20px; font-weight: 300; }
    
    .breathing-circle {
      width: 200px;
      height: 200px;
      border-radius: 50%;
      background: radial-gradient(circle, #238636 0%, #0d1117 70%);
      margin: 0 auto 30px;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: transform 4s ease-in-out, box-shadow 4s ease-in-out;
      box-shadow: 0 0 30px rgba(35, 134, 54, 0.3);
    }
    
    .breathing-circle.inhale {
      transform: scale(1.3);
      box-shadow: 0 0 60px rgba(35, 134, 54, 0.5);
    }
    
    .breathing-circle.exhale {
      transform: scale(1);
      box-shadow: 0 0 30px rgba(35, 134, 54, 0.3);
    }
    
    .breathing-text {
      font-size: 18px;
      color: white;
      font-weight: 300;
      text-transform: uppercase;
      letter-spacing: 3px;
    }
    
    .timer {
      font-size: 64px;
      font-weight: 200;
      margin-bottom: 30px;
      font-family: 'SF Mono', monospace;
    }
    
    .presets {
      display: flex;
      justify-content: center;
      gap: 10px;
      margin-bottom: 20px;
      flex-wrap: wrap;
    }
    
    .preset {
      background: #21262d;
      border: 1px solid #30363d;
      color: #8b949e;
      padding: 10px 20px;
      border-radius: 20px;
      cursor: pointer;
      font-size: 14px;
      transition: all 0.2s;
    }
    
    .preset:hover { background: #30363d; color: #c9d1d9; }
    .preset.active { background: #238636; border-color: #238636; color: white; }
    
    .controls {
      display: flex;
      justify-content: center;
      gap: 12px;
    }
    
    .btn {
      width: 60px;
      height: 60px;
      border-radius: 50%;
      border: 2px solid #30363d;
      background: #161b22;
      color: #c9d1d9;
      font-size: 24px;
      cursor: pointer;
      transition: all 0.2s;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .btn:hover { background: #21262d; }
    
    .btn-play { border-color: #238636; color: #3fb950; }
    .btn-play:hover { background: rgba(35, 134, 54, 0.2); }
    
    .stats {
      margin-top: 40px;
      padding: 20px;
      background: #161b22;
      border-radius: 12px;
      border: 1px solid #30363d;
    }
    
    .stats-title {
      font-size: 12px;
      color: #8b949e;
      text-transform: uppercase;
      margin-bottom: 12px;
    }
    
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 20px;
    }
    
    .stat-value { font-size: 24px; font-weight: 700; color: #58a6ff; }
    .stat-label { font-size: 11px; color: #8b949e; }
    
    .quote {
      margin-top: 30px;
      font-style: italic;
      color: #6e7681;
      font-size: 14px;
      line-height: 1.6;
    }
    
    .sound-toggle {
      position: absolute;
      top: 20px;
      right: 20px;
      background: #21262d;
      border: 1px solid #30363d;
      border-radius: 8px;
      padding: 8px 12px;
      color: #8b949e;
      cursor: pointer;
      font-size: 14px;
    }
    
    .sound-toggle:hover { background: #30363d; }
  </style>
</head>
<body>
  <button class="sound-toggle" id="sound-toggle">ðŸ”” Sound On</button>
  
  <div class="container">
    <h1 class="title">ðŸ§˜ Meditation</h1>
    
    <div class="breathing-circle" id="breathing-circle">
      <span class="breathing-text" id="breathing-text">Ready</span>
    </div>
    
    <div class="timer" id="timer">05:00</div>
    
    <div class="presets">
      <button class="preset" data-minutes="1">1 min</button>
      <button class="preset" data-minutes="3">3 min</button>
      <button class="preset active" data-minutes="5">5 min</button>
      <button class="preset" data-minutes="10">10 min</button>
      <button class="preset" data-minutes="15">15 min</button>
      <button class="preset" data-minutes="20">20 min</button>
    </div>
    
    <div class="controls">
      <button class="btn" id="reset-btn">â†º</button>
      <button class="btn btn-play" id="play-btn">â–¶</button>
    </div>
    
    <div class="stats">
      <div class="stats-title">Your Practice</div>
      <div class="stats-grid">
        <div>
          <div class="stat-value" id="total-sessions">0</div>
          <div class="stat-label">Sessions</div>
        </div>
        <div>
          <div class="stat-value" id="total-minutes">0</div>
          <div class="stat-label">Minutes</div>
        </div>
        <div>
          <div class="stat-value" id="streak">0</div>
          <div class="stat-label">Day Streak</div>
        </div>
      </div>
    </div>
    
    <div class="quote" id="quote">
      "The present moment is the only moment available to us, and it is the door to all moments."
    </div>
  </div>
  
  <script src="https://clawdos.space/sdk/clawd-miniapp-sdk.js"></script>
  <script>
    try { if (window.clawd) clawd.ready(); } catch(e) {}
    
    const quotes = [
      "The present moment is the only moment available to us, and it is the door to all moments.",
      "Feelings come and go like clouds in a windy sky. Conscious breathing is my anchor.",
      "In today's rush, we all think too much, seek too much, want too much â€” and forget about the joy of just being.",
      "The mind is everything. What you think you become.",
      "Quiet the mind, and the soul will speak.",
      "Meditation is not about stopping thoughts, but recognizing that we are more than our thoughts.",
      "The goal of meditation isn't to control your thoughts, it's to stop letting them control you."
    ];
    
    let duration = 5 * 60;
    let remaining = duration;
    let isRunning = false;
    let interval = null;
    let breathingInterval = null;
    let soundEnabled = true;
    
    const circle = document.getElementById('breathing-circle');
    const breathingText = document.getElementById('breathing-text');
    const timerEl = document.getElementById('timer');
    const playBtn = document.getElementById('play-btn');
    
    // Audio context for sounds
    let audioCtx = null;
    
    function playTone(freq, duration) {
      if (!soundEnabled) return;
      if (!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)();
      
      const osc = audioCtx.createOscillator();
      const gain = audioCtx.createGain();
      osc.connect(gain);
      gain.connect(audioCtx.destination);
      
      osc.frequency.value = freq;
      osc.type = 'sine';
      gain.gain.setValueAtTime(0.3, audioCtx.currentTime);
      gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + duration);
      
      osc.start();
      osc.stop(audioCtx.currentTime + duration);
    }
    
    function formatTime(seconds) {
      const m = Math.floor(seconds / 60);
      const s = seconds % 60;
      return `${String(m).padStart(2, '0')}:${String(s).padStart(2, '0')}`;
    }
    
    function updateTimer() {
      timerEl.textContent = formatTime(remaining);
    }
    
    function breathingCycle() {
      // Inhale
      circle.classList.remove('exhale');
      circle.classList.add('inhale');
      breathingText.textContent = 'Inhale';
      playTone(440, 0.3);
      
      setTimeout(() => {
        // Exhale
        circle.classList.remove('inhale');
        circle.classList.add('exhale');
        breathingText.textContent = 'Exhale';
        playTone(330, 0.3);
      }, 4000);
    }
    
    function start() {
      if (isRunning) {
        // Pause
        isRunning = false;
        clearInterval(interval);
        clearInterval(breathingInterval);
        playBtn.textContent = 'â–¶';
        circle.classList.remove('inhale', 'exhale');
        breathingText.textContent = 'Paused';
      } else {
        // Start
        isRunning = true;
        playBtn.textContent = 'â¸';
        playTone(523, 0.5);
        
        breathingCycle();
        breathingInterval = setInterval(breathingCycle, 8000);
        
        interval = setInterval(() => {
          remaining--;
          updateTimer();
          
          if (remaining <= 0) {
            complete();
          }
        }, 1000);
      }
    }
    
    function complete() {
      isRunning = false;
      clearInterval(interval);
      clearInterval(breathingInterval);
      playBtn.textContent = 'â–¶';
      circle.classList.remove('inhale', 'exhale');
      breathingText.textContent = 'Complete';
      
      // Play completion sound
      playTone(523, 0.5);
      setTimeout(() => playTone(659, 0.5), 200);
      setTimeout(() => playTone(784, 0.8), 400);
      
      // Save stats
      const stats = JSON.parse(localStorage.getItem('meditation-stats') || '{"sessions":0,"minutes":0,"lastDate":""}');
      stats.sessions++;
      stats.minutes += Math.round(duration / 60);
      
      const today = new Date().toDateString();
      if (stats.lastDate !== today) {
        const yesterday = new Date(Date.now() - 86400000).toDateString();
        if (stats.lastDate === yesterday) {
          stats.streak = (stats.streak || 0) + 1;
        } else {
          stats.streak = 1;
        }
        stats.lastDate = today;
      }
      
      localStorage.setItem('meditation-stats', JSON.stringify(stats));
      updateStats();
      
      // Show new quote
      document.getElementById('quote').textContent = `"${quotes[Math.floor(Math.random() * quotes.length)]}"`;
    }
    
    function reset() {
      isRunning = false;
      clearInterval(interval);
      clearInterval(breathingInterval);
      remaining = duration;
      updateTimer();
      playBtn.textContent = 'â–¶';
      circle.classList.remove('inhale', 'exhale');
      breathingText.textContent = 'Ready';
    }
    
    function setDuration(minutes) {
      duration = minutes * 60;
      remaining = duration;
      updateTimer();
      
      document.querySelectorAll('.preset').forEach(btn => {
        btn.classList.toggle('active', parseInt(btn.dataset.minutes) === minutes);
      });
    }
    
    function updateStats() {
      const stats = JSON.parse(localStorage.getItem('meditation-stats') || '{"sessions":0,"minutes":0,"streak":0}');
      document.getElementById('total-sessions').textContent = stats.sessions;
      document.getElementById('total-minutes').textContent = stats.minutes;
      document.getElementById('streak').textContent = stats.streak || 0;
    }
    
    // Event listeners
    playBtn.addEventListener('click', start);
    document.getElementById('reset-btn').addEventListener('click', reset);
    
    document.querySelectorAll('.preset').forEach(btn => {
      btn.addEventListener('click', () => {
        setDuration(parseInt(btn.dataset.minutes));
        reset();
      });
    });
    
    document.getElementById('sound-toggle').addEventListener('click', function() {
      soundEnabled = !soundEnabled;
      this.textContent = soundEnabled ? 'ðŸ”” Sound On' : 'ðŸ”• Sound Off';
    });
    
    // Init
    updateStats();
    updateTimer();
  </script>
</body>
</html>
